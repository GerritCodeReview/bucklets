{
  "comments": [
    {
      "key": {
        "uuid": "8430d27f_56c3d472",
        "filename": "gerrit_plugin.bucklet",
        "patchSetId": 1
      },
      "lineNbr": 88,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2015-09-09T06:19:45Z",
      "side": 1,
      "message": "This is only partly a problem of this change: but this code would have issue with Buck cache. After switching to different commit, the mf_cmd wouldn\u0027t change, because it\u0027s just a string and independent from the commit, this part of the string would be still: \"v\u003d\\$(git describe --always HEAD)\", consequently, the command in genrule on line 98 will not be evaluated and new MANTIFEST file wouldn\u0027t be created, so we would end up with stale plugin version. Before this change all plugins that uses VERSION file would notice that, as the version is always stable. After this change, the right version will only be retrieved once and never again, unless the Buck cache is wiped out. Gerrit core fixed it with method invocation, that always try to retrieve the commit.",
      "range": {
        "startLine": 88,
        "startChar": 13,
        "endLine": 88,
        "endChar": 51
      },
      "revId": "b5dd5a3affffc89082a3c175d0249a165db20925",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a4f236e4_4f15ad75",
        "filename": "gerrit_plugin.bucklet",
        "patchSetId": 1
      },
      "lineNbr": 88,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2015-09-09T06:27:43Z",
      "side": 1,
      "message": "Yes, this is only a partial fix to the larger problem that plugin builds are messed up.\n\nA number of times I\u0027ve made changes, rebuilt, but then found that the generated jar file doesn\u0027t include the changes.",
      "parentUuid": "8430d27f_56c3d472",
      "range": {
        "startLine": 88,
        "startChar": 13,
        "endLine": 88,
        "endChar": 51
      },
      "revId": "b5dd5a3affffc89082a3c175d0249a165db20925",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8430d27f_16cd5c9c",
        "filename": "gerrit_plugin.bucklet",
        "patchSetId": 1
      },
      "lineNbr": 88,
      "author": {
        "id": 1014252
      },
      "writtenOn": "2015-09-09T06:43:49Z",
      "side": 1,
      "message": "Would it make sense to use a similar approach as in gerrit?\n\n(copy paste untested)\n---8\u003c-------\ncmd \u003d [\u0027git\u0027, \u0027describe\u0027, \u0027--always\u0027, \u0027--match\u0027, \u0027v[0-9].*\u0027, \u0027--dirty\u0027 ,\u0027HEAD\u0027]\np \u003d subprocess.Popen(cmd, stdout \u003d subprocess.PIPE)\nmf_cmd \u003d \u0027v\u003d\\%s;\u0027 % p.communicate()[0].strip()\n---\u003e8-------",
      "parentUuid": "a4f236e4_4f15ad75",
      "range": {
        "startLine": 88,
        "startChar": 13,
        "endLine": 88,
        "endChar": 51
      },
      "revId": "b5dd5a3affffc89082a3c175d0249a165db20925",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c4bacaed_9859b578",
        "filename": "gerrit_plugin.bucklet",
        "patchSetId": 1
      },
      "lineNbr": 88,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2015-09-09T12:35:23Z",
      "side": 1,
      "message": "Yes, I will try it with something like that tomorrow.\n\nNote that the in-tree build also needs fixing.  Currently the plugin version is set to the git describe value of the core gerrit checkout in which it\u0027s built.  I.e. *not* the git describe of the plugin itself.",
      "parentUuid": "8430d27f_16cd5c9c",
      "range": {
        "startLine": 88,
        "startChar": 13,
        "endLine": 88,
        "endChar": 51
      },
      "revId": "b5dd5a3affffc89082a3c175d0249a165db20925",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8430d27f_f601c045",
        "filename": "gerrit_plugin.bucklet",
        "patchSetId": 1
      },
      "lineNbr": 88,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2015-09-09T13:46:33Z",
      "side": 1,
      "message": "| Note that the in-tree build also needs fixing. Currently the plugin version is set to the git describe value of the core gerrit checkout in which it\u0027s built.  I.e. *not* the git describe of the plugin itself.\n\nHasn\u0027t this been fixed in context of this change: [1]?\n\n* [1] https://gerrit-review.googlesource.com/#/c/70074/3/tools/default.defs@138",
      "parentUuid": "c4bacaed_9859b578",
      "range": {
        "startLine": 88,
        "startChar": 13,
        "endLine": 88,
        "endChar": 51
      },
      "revId": "b5dd5a3affffc89082a3c175d0249a165db20925",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a4195610_b7590878",
        "filename": "gerrit_plugin.bucklet",
        "patchSetId": 1
      },
      "lineNbr": 88,
      "author": {
        "id": 1014252
      },
      "writtenOn": "2015-09-10T09:57:42Z",
      "side": 1,
      "message": "That was my impression also.",
      "parentUuid": "8430d27f_f601c045",
      "range": {
        "startLine": 88,
        "startChar": 13,
        "endLine": 88,
        "endChar": 51
      },
      "revId": "b5dd5a3affffc89082a3c175d0249a165db20925",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}